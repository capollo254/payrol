{"ast":null,"code":"// src/pages/employee/MyPayslipsPage.js\nimport React,{useEffect,useState}from'react';import api from'../../api/auth';// Using the same axios instance with auth headers\nimport{useNavigate}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const MyPayslipsPage=()=>{const[payslips,setPayslips]=useState([]);const[loading,setLoading]=useState(true);const navigate=useNavigate();useEffect(()=>{const fetchPayslips=async()=>{const token=localStorage.getItem('token');if(!token){navigate('/login');return;}try{const response=await api.get('payslips/',{headers:{Authorization:\"Token \".concat(token)}});setPayslips(response.data);}catch(error){console.error('Failed to fetch payslips:',error);// Handle token expiration or invalid token\nif(error.response&&error.response.status===401){localStorage.removeItem('token');localStorage.removeItem('role');navigate('/login');}}finally{setLoading(false);}};fetchPayslips();},[navigate]);if(loading){return/*#__PURE__*/_jsx(\"div\",{style:{padding:'20px'},children:\"Loading payslips...\"});}return/*#__PURE__*/_jsxs(\"div\",{style:{padding:'20px'},children:[/*#__PURE__*/_jsx(\"h2\",{style:{marginBottom:'20px'},children:\"My Payslips\"}),payslips.length>0?payslips.map(payslip=>/*#__PURE__*/_jsxs(\"div\",{style:{border:'1px solid #ccc',padding:'15px',marginBottom:'15px',borderRadius:'8px'},children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"Payslip for \",payslip.employee_name]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Period:\"}),\" \",payslip.payroll_run.period_start_date,\" to \",payslip.payroll_run.period_end_date]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Net Pay:\"}),\" KES \",payslip.net_pay]})]},payslip.id)):/*#__PURE__*/_jsx(\"p\",{children:\"No payslips found.\"})]});};export default MyPayslipsPage;","map":{"version":3,"names":["React","useEffect","useState","api","useNavigate","jsx","_jsx","jsxs","_jsxs","MyPayslipsPage","payslips","setPayslips","loading","setLoading","navigate","fetchPayslips","token","localStorage","getItem","response","get","headers","Authorization","concat","data","error","console","status","removeItem","style","padding","children","marginBottom","length","map","payslip","border","borderRadius","employee_name","payroll_run","period_start_date","period_end_date","net_pay","id"],"sources":["C:/Users/Code_AI/Documents/PAYROL SYSTEM COMPLEX/Apollo PAYROL SYSTEM - backup 3 working backend/kenyan_payroll_system/frontend/src/pages/employee/MyPayslipsPage.js"],"sourcesContent":["// src/pages/employee/MyPayslipsPage.js\r\n\r\nimport React, { useEffect, useState } from 'react';\r\nimport api from '../../api/auth'; // Using the same axios instance with auth headers\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nconst MyPayslipsPage = () => {\r\n  const [payslips, setPayslips] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    const fetchPayslips = async () => {\r\n      const token = localStorage.getItem('token');\r\n      if (!token) {\r\n        navigate('/login');\r\n        return;\r\n      }\r\n      try {\r\n        const response = await api.get('payslips/', {\r\n          headers: {\r\n            Authorization: `Token ${token}`,\r\n          },\r\n        });\r\n        setPayslips(response.data);\r\n      } catch (error) {\r\n        console.error('Failed to fetch payslips:', error);\r\n        // Handle token expiration or invalid token\r\n        if (error.response && error.response.status === 401) {\r\n          localStorage.removeItem('token');\r\n          localStorage.removeItem('role');\r\n          navigate('/login');\r\n        }\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchPayslips();\r\n  }, [navigate]);\r\n\r\n  if (loading) {\r\n    return <div style={{ padding: '20px' }}>Loading payslips...</div>;\r\n  }\r\n\r\n  return (\r\n    <div style={{ padding: '20px' }}>\r\n      <h2 style={{ marginBottom: '20px' }}>My Payslips</h2>\r\n      {payslips.length > 0 ? (\r\n        payslips.map(payslip => (\r\n          <div key={payslip.id} style={{ border: '1px solid #ccc', padding: '15px', marginBottom: '15px', borderRadius: '8px' }}>\r\n            <h3>Payslip for {payslip.employee_name}</h3>\r\n            <p><strong>Period:</strong> {payslip.payroll_run.period_start_date} to {payslip.payroll_run.period_end_date}</p>\r\n            <p><strong>Net Pay:</strong> KES {payslip.net_pay}</p>\r\n          </div>\r\n        ))\r\n      ) : (\r\n        <p>No payslips found.</p>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MyPayslipsPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}